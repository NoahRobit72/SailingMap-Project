// netlifyFunction.js
const fs = require('fs');

exports.handler = async (event, context) => {
    try {

        const { time } = event.queryStringParameters;
        
        // Process the arguments
        console.log("Argument 1:", time);

        const locationObject = {
            lat: data[time][0], // Latitude value
            lon: data[time][1], // Longitude value
            angle: data[time][4] // Heading value (in degrees)
        };
        
        // Set response headers
        const headers = {
            'Content-Type': 'text/csv',
        };
        
        // Return response with CSV data
        return {
            statusCode: 200,
            headers,
            body: JSON.stringify(locationObject),
        };
    } catch (error) {
        // Handle errors
        return {
            statusCode: 500,
            body: JSON.stringify({ error: 'Internal Server Error' }),
        };
    }
};

// Format
// Latidude, Longitude, Altidude, Speed, Course Heading, hacc?
data = [
[42.34255,-71.10562,9.843,0,0,35],
[42.34248,-71.1056,6.964,1.449,149.832,17.274],
[42.34249,-71.10565,6.589,1.262,165.881,13.119],
[42.34246,-71.10566,6.533,0.892,177.382,10.807],
[42.34245,-71.10566,6.447,0.46,130.854,10.03],
[42.34245,-71.10568,6.501,0.5,106.125,8.736],
[42.34243,-71.10566,6.568,0.5,125.012,14.315],
[42.34243,-71.10566,6.623,0.834,93.192,17.236],
[42.34244,-71.10567,6.73,0.834,49.429,22.867],
[42.34244,-71.10566,6.575,0.471,80.462,26.146],
[42.34241,-71.10565,6.782,0.471,118.813,10.828],
[42.3424,-71.10564,7.064,0.471,132.182,20.016],
[42.34239,-71.10564,7.064,0.471,132.182,20.016],
[42.34238,-71.10562,7.07,0.509,122.861,12.691],
[42.34236,-71.10562,7.052,0.509,155.886,13.681],
[42.34235,-71.1056,7.135,0.681,155.783,14.537],
[42.34233,-71.10558,7.14,0.717,150.482,14.529],
[42.34231,-71.10557,7.24,0.717,161.94,12.71],
[42.34229,-71.10548,7.471,1.038,136.011,24.693],
[42.34228,-71.10544,7.398,1.038,131.7,21.17],
[42.3423,-71.10542,7.187,1.021,75.979,11.676],
[42.34231,-71.10539,7.022,1.166,70.787,13.472],
[42.34232,-71.10537,6.845,1.166,60.67,9.325],
[42.34233,-71.10534,6.614,1.383,60.014,11.389],
[42.34235,-71.10531,6.169,1.446,56.463,21.916],
[42.34236,-71.10528,6.029,1.376,50.34,23.477],
[42.34236,-71.10525,5.663,1.385,47.092,22.372],
[42.34236,-71.10523,5.588,1.376,55.744,18.666],
[42.34237,-71.10522,5.499,1.236,55.744,19.633],
[42.34237,-71.10517,5.134,1.285,55.744,13.445],
[42.34236,-71.10513,4.666,1.318,55.744,11.082],
[42.34236,-71.10511,4.581,1.285,55.744,10.945],
[42.34241,-71.10498,2.856,1.781,56.407,14.39],
[42.34241,-71.10499,1.85,1.513,24.668,14.328],
[42.34241,-71.10498,2.083,1.199,56.407,14.303],
[42.34241,-71.10498,1.833,1.179,56.407,14.276],
[42.34242,-71.10497,2.506,1.368,62.575,14.259],
[42.34243,-71.10496,2.223,1.597,62.575,14.24],
[42.34242,-71.10496,1.906,1.765,62.575,14.23],
[42.34243,-71.10498,1.824,1.613,62.575,14.223],
[42.34245,-71.10499,1.944,1.666,62.575,14.216],
[42.34248,-71.10502,2.516,1.148,62.575,14.207],
[42.34249,-71.10504,3.061,1.602,242.575,14.207],
[42.3425,-71.10505,2.907,1.442,242.575,14.213],
[42.34251,-71.10503,2.205,1.372,26.972,14.22],
[42.34251,-71.10504,2.346,1.406,327.39,14.222],
[42.34252,-71.10504,2.964,1.526,325.537,14.228],
[42.34254,-71.10505,3.295,1.505,325.777,14.232],
[42.34255,-71.10507,3.09,1.641,322.967,14.234],
[42.34256,-71.10509,2.98,1.616,314.888,14.222],
[42.34261,-71.10516,3.067,1.636,326.091,14.223],
[42.34263,-71.10518,2.309,1.616,329.89,14.222],
[42.34265,-71.10521,2.121,1.621,333.35,14.222],
[42.34266,-71.10523,2.439,1.645,333.35,14.223],
[42.34268,-71.10525,2.602,1.692,339.157,14.224],
[42.34271,-71.10527,2.539,1.711,346.82,14.222],
[42.34275,-71.10527,2.341,1.628,12.85,14.221],
[42.34277,-71.10526,1.872,1.582,12.85,14.221],
[42.34279,-71.10526,1.923,1.51,12.85,14.221],
[42.3428,-71.10525,1.492,1.576,350.381,14.218],
[42.34278,-71.10526,0.707,1.531,333.335,14.219],
[42.34279,-71.10528,0.813,1.637,312.292,14.22],
[42.34279,-71.1053,0.827,1.626,312.292,4.674],
[42.3428,-71.10531,0.785,1.651,312.292,4.668],
[42.34281,-71.10533,1.847,1.656,312.292,4.687],
[42.34282,-71.10534,2.071,1.388,312.292,4.715],
[42.34283,-71.10536,1.156,1.338,314.684,4.755],
[42.34284,-71.10538,2.49,1.343,314.684,4.789],
[42.34286,-71.10539,2.099,1.462,314.684,4.805],
[42.34286,-71.1054,1.207,1.165,314.684,4.829],
[42.34288,-71.10542,2.036,1.49,314.684,4.837],
[42.3429,-71.10545,1.093,1.742,314.684,4.881],
[42.3429,-71.10546,0.192,1.564,314.684,4.912],
[42.34292,-71.10548,1.847,1.592,314.684,4.921],
[42.34293,-71.10549,2.531,1.572,314.684,4.897],
[42.34294,-71.10551,1.357,1.711,314.684,4.873],
[42.34295,-71.10552,0.731,1.604,314.684,4.837],
[42.34296,-71.10554,1.136,1.64,314.684,4.809],
[42.34297,-71.10555,1.348,1.651,316.743,4.789],
[42.34298,-71.10557,1.634,1.655,316.743,4.781],
[42.34298,-71.10558,2.347,1.606,257.549,4.767],
[42.34298,-71.10558,2.867,1.631,246.227,4.758],
[42.34296,-71.10559,3.13,1.673,231.855,4.747],
[42.34295,-71.1056,3.161,1.692,232.357,4.738],
[42.34295,-71.10562,3.206,1.673,239.781,4.725],
[42.34294,-71.10564,3.658,1.661,240.682,4.723],
[42.34292,-71.10566,3.636,1.694,224.558,4.718],
[42.34288,-71.10571,3.729,1.688,216.371,4.704],
[42.34287,-71.10573,4.089,1.667,216.371,4.675],
[42.34285,-71.10574,3.921,1.693,216.371,4.67],
[42.34284,-71.10576,3.845,1.705,216.57,4.664],
[42.34282,-71.10577,3.838,1.683,216.57,4.659],
[42.34281,-71.10578,4.238,1.681,216.57,4.652],
[42.3428,-71.10579,4.773,1.672,216.57,4.644],
[42.34278,-71.1058,4.879,1.672,216.57,4.642],
[42.34276,-71.1058,5.157,1.675,216.57,4.639],
[42.34275,-71.10579,4.87,1.692,165.588,4.636],
[42.34275,-71.10579,4.939,1.675,151.21,4.638],
[42.34274,-71.10578,4.81,1.694,142.804,4.643],
[42.34273,-71.10578,4.974,1.693,141.818,4.653],
[42.34273,-71.10576,5.281,1.676,135.224,4.668],
[42.34271,-71.10574,4.89,1.69,135.076,4.683],
[42.3427,-71.10573,5.009,1.678,138.232,4.699],
[42.34269,-71.1057,5.154,1.651,138.896,4.716],
[42.34267,-71.10568,5.517,1.607,133.528,4.728],
]
